---
import Customerlayout from "src/shares/customerlayout.astro";
import { RestaurantService } from "@service/RestaurantService";

const service = new RestaurantService();
const data = await service.GetListRestaurant();

const props = {data : data};
---
<Customerlayout>
    <section id="home" class="welcome-hero">
			<div class="container">
				<div class="welcome-hero-txt">
					<h2>best place to find and explore <br> that all you need </h2>
					<p>
						Best Place, Restaurant, Food and Drink
					</p>
				</div>
				<div class="welcome-hero-serch-box">
					<div class="welcome-hero-form">
						<div class="single-welcome-hero-form">
							<h3>what?</h3>
							<form method="POST" id="searchForm" target="_blank">
								<input id="searchInput" type="text" placeholder="search" name="search" placeholder="Ex: Location, Restaurant, Food" />
							</form>
						</div>
					</div>
					<div class="welcome-hero-serch">
						<button id="search-btn" type="submit" class="welcome-hero-btn">
							 search  <i data-feather="search"></i> 
						</button>
					</div>
				</div>
			</div>

		</section><!--/.welcome-hero-->
		<section id="works" class="works">
			<div class="container">
				<div class="works-content">
		</section><!--/.works-->
		<section id="explore" class="explore">
			<div class="container">
				<div class="section-header">
					<h2>Explore our Restaurant</h2>
					<h3>Explore New place, Food and Drink</h3>
				</div>
				<div class="explore-content">
					<div class="row">
						{
							props.data.map(item => (
							<div class=" col-md-4 col-sm-6">
							<div class="single-explore-item">
								<div class="single-explore-img">
									<img src={item?.imageList[0]}/> 
									<div class="single-explore-img-info">
										<button>best rated</button>
										<div class="single-explore-image-icon-box">
											<ul>
												<li>
													<div class="single-explore-image-icon">
														<i class="fa fa-arrows-alt"></i>
													</div>
												</li>
												<li>
													<div class="single-explore-image-icon">
														<i class="fa fa-bookmark-o"></i>
													</div>
												</li>
											</ul>
										</div>
									</div>
								</div>
								<div class="single-explore-txt bg-theme-1">
									<h2><a href={"/Restaurant/Detail/" + item.id} >{item.restaurantName}</a></h2>
									<p class="explore-rating-price">
										<span class="explore-rating">{item.averageRating}</span>
										<a> 10 ratings</a> 
										<span class="explore-price-box">
											from
											<span class="explore-price">{item.city}</span>
										</span>
										 <a>{item.country}</a>
									</p>
									<div class="explore-person">
										<div class="row">
											<div class="col-sm-2">
											</div>
											<div class="col-sm-10">
												<p>
													{item.address}
												</p>
											</div>
										</div>
									</div>
									<div class="explore-open-close-part">
										<div class="row">
											<div class="col-sm-5">
												<a href={"/Restaurant/Detail/" + item.id}>Explore now</a>
											</div>
											<div class="col-sm-7">
												<div class="explore-map-icon">
													<a href="#"><i data-feather="map-pin"></i></a>
													<a href="#"><i data-feather="upload"></i></a>
													<a href="#"><i data-feather="heart"></i></a>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
							))
						}
					</div>
				</div>
			</div>
		</section>		
		<script>
			const buttonSearch = document.getElementById("search-btn") as HTMLButtonElement;
			const searchValue = document.getElementById("searchForm") as HTMLInputElement;
			buttonSearch?.addEventListener("click", (event : MouseEvent) => {
				const value = searchValue.textContent;
				window.location.href = "/Restaurant/Search/" + value;
			})

			document.addEventListener("DOMContentLoaded", () => {
				const form = document.getElementById("searchForm");
				form!.addEventListener("submit", async (event) => {
					event.preventDefault();
					const formData = new FormData(form as any);
					const searchValue = formData.get("searchInput");
					const url = "Restaurant/Search/" + searchValue;
					
				})
			})
		</script>
</Customerlayout>